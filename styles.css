/* Sleepy Hallow Media — Magazine Theme (v5.1)
   - Light(default)/Dark(toggle) theming via html[data-theme="dark"]
   - Centered layout, lead + right-rail front page
   - Overflow fixes and resilient typography
   - Compatible with script.js v5.1
*/

/* ============================================================
   THEME TOKENS
   Light theme is default (:root). Dark theme overrides via
   :root[data-theme="dark"] — matches script.js toggling.
   ============================================================ */

/* ---------- Light tokens (default) ---------- */
:root {
  /* Base palette (light) */
  --bg: #f6f8fc;
  --surface: #ffffff;
  --surface-2: #f2f5fb;
  --ink: #0e1a2a;
  --muted: #667792;
  --border: #dfe5ef;

  /* Brand & accents */
  --accent: #0f3e56;            /* primary */
  --accent-ink: #e9f2f7;        /* text-on-accent (light chip) */
  --accent-2: #d48c45;          /* warm secondary */

  /* Links */
  --link: #0f3e56;
  --link-hover: color-mix(in oklab, var(--accent), black 15%);

  /* Chips */
  --chip-bg: #ffdba8;
  --chip-ink: #0e1a2a;

  /* Elevation */
  --radius: 12px;
  --shadow-sm: 0 2px 8px rgba(0,0,0,.06);
  --shadow-md: 0 8px 28px rgba(0,0,0,.12);
  --shadow-lg: 0 14px 48px rgba(0,0,0,.16);

  /* Spacing (8px rhythm) */
  --space-1: 4px; --space-2: 8px; --space-3: 12px; --space-4: 16px; --space-5: 20px;
  --space-6: 24px; --space-7: 28px; --space-8: 32px; --space-9: 40px; --space-10: 48px;

  /* Gutter */
  --g-gap: var(--space-4);

  /* Type scale */
  --font-body: clamp(16px, 0.95rem + 0.2vw, 17.5px);
  --h0: clamp(2.4rem, 1.4rem + 3.2vw, 3.2rem);
  --h1: clamp(2.0rem, 1.3rem + 2.2vw, 2.6rem);
  --h2: clamp(1.6rem, 1.15rem + 1.4vw, 2.0rem);
  --h3: clamp(1.25rem, 1.05rem + 0.8vw, 1.5rem);
  --lh-body: 1.7;
  --lh-heading: 1.25;
  --measure: 72ch;

  /* Focus ring */
  --ring: 2px solid color-mix(in oklab, var(--accent), white 30%);

  /* Buttons (light) */
  --btn-bg: var(--accent);
  --btn-ink: #ffffff;
  --btn-bg-hover: color-mix(in oklab, var(--accent), black 10%);
  --btn-bg-active: color-mix(in oklab, var(--accent), black 18%);

  /* Surface hover */
  --surface-hover: color-mix(in oklab, var(--surface), black 3%);

  /* Layout */
  --wrap: 1180px;
  --rail-left: 1.65fr;
  --rail-right: 1fr;

  /* Header & bars (light) */
  --topbar-bg: #d9ecff;
  --topbar-ink: #0f2e4b;
  --topbar-line: #c9def3;

  --header-bg: color-mix(in oklab, #ffffff, #eaf0f7 18%);
  --header-line: #e2e7f0;

  --trend-bg: #f0f5fc;
  --trend-line: #e2e7f2;

  /* Panel accents (lead/rail) in light */
  --lead-bg: color-mix(in oklab, #ffffff, var(--accent) 8%);
  --panel-line: #e1e6f0;

  /* Card backgrounds (light) */
  --card-bg: #ffffff;
  --card-bg-hover: color-mix(in oklab, #ffffff, #eaf0f7 12%);
  --thumb-bg: #e1ebf4;

  /* Share chip (light-ish) */
  --share-bg: color-mix(in oklab, var(--accent), white 88%);
  --share-line: color-mix(in oklab, var(--accent), white 60%);
  --share-ink: color-mix(in oklab, var(--accent), black 10%);
}

/* ---------- Dark tokens (override when html[data-theme="dark"]) ---------- */
:root[data-theme="dark"] {
  --bg: #0d1117;
  --surface: #111827;
  --surface-2: #0f172a;
  --ink: #e5ecff;
  --muted: #98a6c7;
  --border: #1f2a44;

  --accent: #7dc0ff;
  --accent-ink: #0a1520;
  --accent-2: #efb077;

  --link: #b9dfff;
  --link-hover: #e1f1ff;

  --chip-bg: #ffdba8;
  --chip-ink: #0e1a2a;

  --shadow-sm: 0 2px 10px rgba(0,0,0,.35);
  --shadow-md: 0 14px 32px rgba(0,0,0,.45);
  --shadow-lg: 0 24px 60px rgba(0,0,0,.55);

  --ring: 2px solid color-mix(in oklab, var(--accent), black 30%);

  --btn-bg: color-mix(in oklab, var(--accent), black 12%);
  --btn-ink: #eaf0ff;
  --btn-bg-hover: color-mix(in oklab, var(--accent), black 22%);
  --btn-bg-active: color-mix(in oklab, var(--accent), black 32%);
  --surface-hover: color-mix(in oklab, var(--surface), white 4%);

  --topbar-bg: #1e3a5f;
  --topbar-ink: #d9ecff;
  --topbar-line: #274a78;

  --header-bg: #0b1220;
  --header-line: #1b2741;

  --trend-bg: #0b1324;
  --trend-line: #1b2a46;

  --lead-bg: #122036;
  --panel-line: #1a2c4b;

  --card-bg: var(--surface);
  --card-bg-hover: #121d34;
  --thumb-bg: #1b2738;

  --share-bg: #142541;
  --share-line: #2a466f;
  --share-ink: #d7e9ff;
}

/* ============================================================
   BASE
   ============================================================ */
* { box-sizing: border-box; }
html, body { height: 100%; }
html { overflow-x: hidden; } /* final guard to prevent stray scroll */
body {
  margin: 0;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color: var(--ink);
  background: var(--bg);
  font-size: var(--font-body);
  line-height: var(--lh-body);
  -webkit-font-smoothing: antialiased;
}

.wrap {
  margin-left: auto;
  margin-right: auto;
  width: min(92%, var(--wrap, 1180px));
}

img { display: block; max-width: 100%; height: auto; }

a {
  color: var(--link);
  text-decoration: none;
  transition: color .18s ease, text-decoration-color .18s ease, opacity .18s ease;
}
a:hover {
  color: var(--link-hover);
  text-decoration: underline;
  text-decoration-thickness: 0.09em;
  text-underline-offset: 0.15em;
}
a:focus-visible { outline: var(--ring); outline-offset: 2px; border-radius: 6px; }

/* Skip link */
.skip-link{ position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }
.skip-link:focus{
  position:static; width:auto; height:auto; padding:.35rem .55rem;
  background: color-mix(in oklab, var(--surface), black 8%);
  color: var(--ink);
  border-radius:8px; border:1px solid var(--border);
}

/* ============================================================
   TOPBAR / HEADER
   ============================================================ */
.topbar { background: var(--topbar-bg); color: var(--topbar-ink); border-bottom: 1px solid var(--topbar-line); }
.topbar-row { display:flex; align-items:center; justify-content:space-between; padding: var(--space-2) 0; }
.top-link { color: var(--topbar-ink); opacity:.95; margin-right: var(--space-3); font-weight:700; }
.top-link:hover { opacity:1; }
.top-search { display:flex; gap: var(--space-2); }
.top-search input {
  border:1px solid color-mix(in oklab, var(--topbar-bg), black 20%);
  background: color-mix(in oklab, var(--topbar-bg), black 10%);
  color: color-mix(in oklab, var(--topbar-ink), white 10%);
  border-radius:10px; padding: var(--space-2) var(--space-3); min-width: 230px;
}
.top-search .btn {
  background: var(--accent-ink); color: var(--accent);
  border:1px solid color-mix(in oklab, var(--accent), white 55%);
  border-radius:10px; padding: var(--space-2) var(--space-3); font-weight:800;
}

.site-header {
  background: var(--header-bg);
  border-bottom:1px solid var(--header-line);
  position: sticky; top:0; z-index:1000;
}
.header-row {
  display:flex; gap: var(--space-4); align-items:center; justify-content:space-between;
  padding: var(--space-4) 0;
}
.brand { display:flex; align-items:center; gap: var(--space-2); font-weight:800; color: var(--ink); }
.brand-mark { width:34px; height:34px; }
.brand-name { font-family:"Playfair Display", Georgia, serif; font-weight:700; letter-spacing:.2px; }
.primary-nav { display:flex; gap: var(--space-5); align-items:center; }
.primary-nav a { color: var(--ink); font-weight:700; }
.primary-nav a:hover { color: var(--link-hover); }
.primary-nav a[aria-current="page"]{ color: var(--link); text-decoration: underline; text-underline-offset: 6px; }

.nav-toggle{
  display:none; background: var(--surface-2); border:1px solid var(--border);
  border-radius:10px; padding:.35rem .55rem; color: var(--ink);
}
.mobile-menu{ display:none; border-top:1px solid var(--header-line); background: var(--surface-2); padding: var(--space-3) 0; }
.mobile-menu a{ display:block; padding:.45rem 4%; color: var(--ink); font-weight:700; }
.header-tools{ display:flex; align-items:center; gap: var(--space-2); }

@media (max-width: 820px){
  .primary-nav{ display:none; }
  .nav-toggle{ display:block; }
  .mobile-menu.active{ display:block; }
}

/* Theme toggle */
.theme-toggle{
  display:inline-flex; align-items:center; justify-content:center;
  border:1px solid var(--border); background: var(--surface-2); color: var(--ink);
  width:36px; height:36px; border-radius:999px; box-shadow: var(--shadow-sm);
}
.theme-toggle:hover{ background: var(--surface-hover); }
.theme-icon{ font-size:1rem; }

/* ============================================================
   TRENDING STRIP
   ============================================================ */
.trending{ background: var(--trend-bg); border-bottom:1px solid var(--trend-line); }
.trend-row { display:flex; align-items:center; gap: var(--space-3); padding: var(--space-3) 0; }
.trend-label{ color: color-mix(in oklab, var(--ink), var(--muted) 35%); font-weight:800; font-size:.95rem; }
.trend-tags{ display:flex; flex-wrap:wrap; gap: var(--space-2); }
.trend-tags a{
  display:inline-block; padding:.3rem .65rem; border-radius:999px;
  background: color-mix(in oklab, var(--accent), white 85%);
  color: color-mix(in oklab, var(--accent), black 25%);
  border:1px solid color-mix(in oklab, var(--accent), white 60%);
  font-weight:800; font-size:.86rem;
}
:root[data-theme="dark"] .trend-tags a{ background:#142541; color:#cfe3ff; border-color:#1e355c; }
.trend-tags a:hover{ filter: brightness(0.98); }

/* ============================================================
   FRONT PAGE GRIDS
   ============================================================ */
.front { padding: var(--space-6) 0 var(--space-10); }

/* Lead + Right rail */
.lead-grid{
  display:grid;
  grid-template-columns: var(--rail-left) var(--rail-right);
  gap: clamp(18px, 2.6vw, 28px);
  align-items: start;
  margin-bottom: clamp(20px, 3vw, 32px);
}
@media (max-width: 980px){ .lead-grid{ grid-template-columns:1fr; } }

.lead-card{
  position:relative; min-height: clamp(320px, 38vw, 520px);
  background: var(--lead-bg);
  border:1px solid var(--panel-line); border-radius:14px; overflow:hidden; box-shadow: var(--shadow-lg);
  display:grid; align-content:end; isolation:isolate;
}
.lead-card::after{ content:""; position:absolute; inset:0; background: linear-gradient(180deg, rgba(0,0,0,0) 35%, rgba(0,0,0,.65) 100%); z-index:0; }
.lead-bg{ position:absolute; inset:0; object-fit:cover; width:100%; height:100%; z-index:-1; }
.lead-body{ position:relative; color:#fff; padding: clamp(16px, 2.8vw, 28px); z-index:1; }

.card-overlay{ position:absolute; inset:0; z-index:2; display:block; border:0; outline:none; }
.card-overlay:focus-visible{ outline: var(--ring); }

.kicker{
  display:inline-block; padding:.2rem .6rem; border-radius:999px;
  background: var(--chip-bg); color: var(--chip-ink);
  font-weight:900; font-size:.82rem; letter-spacing:.2px; margin-bottom: var(--space-3);
}

.lead-title, .a-title, h1{
  font-family:"Playfair Display", Georgia, serif; font-weight:700; line-height: var(--lh-heading);
  margin: 0.15em 0 0.35em; font-size: var(--h1);
}
.front .lead-title { font-size: var(--h0); }
.lead-meta{ opacity:.95; font-weight:700; color: color-mix(in oklab, white, black 0%); }

/* Right rail list */
.right-rail { display:block; }
.top-stories{ display:grid; grid-template-columns:1fr; gap: clamp(10px, 1.4vw, 14px); }
.top-card{
  display:grid; grid-template-columns: 104px 1fr; gap: 12px;
  background: var(--card-bg);
  border:1px solid var(--panel-line); border-radius: 12px; overflow:hidden; box-shadow: var(--shadow-sm);
}
.top-card:hover{ box-shadow: var(--shadow-md); background: var(--card-bg-hover); transform: translateY(-1px); }
.top-thumb{ width:100%; height:100%; object-fit:cover; min-height:94px; background: var(--thumb-bg); }
.top-body{ padding: 12px 14px; }
.top-title, .card-title{
  font-weight:900; line-height:1.22; font-size: var(--h3); margin: 0 0 6px 0;
}
.top-title a, .card-title a{ color: var(--ink); }
:root[data-theme="dark"] .top-title a,
:root[data-theme="dark"] .card-title a{ color:#e9f1ff; }
.top-title a:hover, .card-title a:hover{ color: var(--link-hover); }
.top-meta{ color: var(--muted); font-size:.92rem; }

/* Latest + sidebar grid */
.content-grid{
  display:grid; grid-template-columns: 2fr 1fr; gap: clamp(18px, 2.6vw, 28px);
}
@media (max-width: 980px){ .content-grid{ grid-template-columns:1fr; } }

.h-section{
  font-family:"Playfair Display", Georgia, serif; font-weight:700; line-height: var(--lh-heading);
  font-size: var(--h2); margin: var(--space-3) 0 var(--space-4);
}

/* Cards grid */
.cards-grid{
  display:grid;
  /* Overflow-safe column sizing on tiny screens */
  grid-template-columns: repeat(auto-fit, minmax(min(260px, 100%), 1fr));
  gap: clamp(12px, 1.8vw, 18px);
}
.card{
  display:flex; flex-direction:column; background: var(--card-bg);
  border:1px solid var(--panel-line); border-radius:12px; overflow:hidden; box-shadow: var(--shadow-sm);
}
.card:hover{ transform: translateY(-2px); box-shadow: var(--shadow-md); background: var(--card-bg-hover); }
.card-img{ width:100%; aspect-ratio:16/9; object-fit:cover; background: var(--thumb-bg); transition: transform .35s ease; }
.card:hover .card-img{ transform: scale(1.015); }
.card-body{ padding: 14px 16px 18px; display:flex; flex-direction:column; gap: 8px; }
.card-meta{ color: var(--muted); font-size:.92rem; }
.card-sub{ margin:0; color: var(--muted); font-size:.95rem; }

/* Chips in cards */
.chip{
  display:inline-block; padding:.18rem .55rem; border-radius:999px;
  background: var(--chip-bg); color: var(--chip-ink);
  font-weight:900; font-size:.78rem; margin-right: 6px;
}

/* Sidebar */
.side-col{ display:flex; flex-direction:column; gap: clamp(12px, 1.6vw, 16px); }
.side-panel{
  background: var(--card-bg); border:1px solid var(--panel-line); border-radius:12px;
  padding: 16px; box-shadow: var(--shadow-sm);
}
.side-panel:hover{ background: var(--card-bg-hover); }
.h-side{ margin:0 0 10px 0; font:700 1.1rem "Playfair Display", Georgia, serif; color: var(--ink); }
:root[data-theme="dark"] .h-side{ color:#e8f0ff; }
.side-list{ list-style:none; margin:0; padding:0; }
.side-list li{ margin: 8px 0; }
.side-list a{ color: var(--ink); font-weight:800; }
:root[data-theme="dark"] .side-list a{ color:#e9f1ff; }
.side-list a:hover{ text-decoration: underline; }
.signup form{ display:flex; gap: 10px; margin: 12px 0; }
.signup input{
  flex:1; border:1px solid var(--border); border-radius:10px; padding: 10px 12px;
  background: var(--surface-2); color: var(--ink);
}
.btn{
  background: var(--btn-bg); color: var(--btn-ink);
  border:1px solid color-mix(in oklab, var(--btn-bg), white 20%); border-radius:10px; padding:.5rem .8rem; font-weight:900;
  box-shadow: var(--shadow-sm);
}
.btn:hover{ background: var(--btn-bg-hover); }
.btn:active{ background: var(--btn-bg-active); }
.btn:focus-visible{ outline: var(--ring); outline-offset: 2px; }

/* ============================================================
   ARTICLE
   ============================================================ */
.a-hero{
  position:relative; min-height: clamp(240px, 38vw, 420px);
  background: var(--lead-bg); display:grid; align-content:end; border-bottom:1px solid var(--header-line);
}
.a-hero-bg{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; object-position:center; display:block; }
.a-hero::after{ content:""; position:absolute; inset:0; background: linear-gradient(180deg, rgba(0,0,0,0) 35%, rgba(0,0,0,.55) 100%); }
.a-hero-inner{ position:relative; color:#fff; padding: 24px 0 28px; }
.a-kicker{ display:inline-block; padding:.18rem .55rem; border-radius:999px; background: var(--chip-bg); color: var(--chip-ink); font-weight:800; font-size:.8rem; margin-bottom: 10px; }
.a-sub{ margin:0 0 10px 0; opacity:.95; line-height:1.4; }
.a-byline{ opacity:.95; font-weight:700; display:flex; gap: 12px; flex-wrap:wrap; }
.article-wrap{ max-width: var(--measure); }

.article-body{
  background: var(--card-bg); border:1px solid var(--panel-line); border-radius:12px;
  box-shadow: var(--shadow-sm);
  padding: clamp(16px, 1.6vw, 20px);
  margin: 24px 0;
}
.article-body p{ font-size: 1rem; line-height: var(--lh-body); margin: 12px 0 12px; max-width: var(--measure); }
.article-body h2{ font-family: "Playfair Display", Georgia, serif; font-weight:700; line-height: var(--lh-heading); font-size: var(--h2); margin: 24px 0 12px; }
.article-body h3{ font-family: "Playfair Display", Georgia, serif; font-weight:700; line-height: var(--lh-heading); font-size: var(--h3); margin: 20px 0 10px; }
.article-body a{ text-decoration-thickness: 0.08em; text-underline-offset: 0.15em; }
.article-body blockquote{
  margin: 20px 0; padding: 14px 16px;
  border-left:4px solid var(--accent-2);
  background: color-mix(in oklab, var(--accent-2), white 85%);
  color: color-mix(in oklab, var(--accent-2), black 30%);
  border-radius:10px;
}
figure{ margin: 20px 0; }
figcaption{ color: var(--muted); font-size:.9rem; margin-top:.3rem; }

.a-tags{ display:flex; flex-wrap:wrap; gap: 8px; margin: 8px 0 16px; }
.a-tags a{ display:inline-block; padding:.18rem .55rem; border-radius:999px; background: var(--chip-bg); color: var(--chip-ink); font-weight:900; font-size:.78rem; }

.share-bar{ display:flex; gap: 10px; flex-wrap:wrap; margin: 16px 0 20px; }
.share-btn{
  display:inline-flex; align-items:center; gap:.45rem;
  padding:.5rem .85rem; border-radius:999px; font-weight:900; font-size:.92rem;
  border:1px solid var(--share-line); background: var(--share-bg); color: var(--share-ink);
  text-decoration:none; cursor:pointer; box-shadow: var(--shadow-sm);
}
.share-btn:hover{ filter: brightness(1.03); transform: translateY(-1px); }
.share-btn:active{ transform: translateY(0); }
.share-btn:focus-visible{ outline: var(--ring); outline-offset: 2px; }

/* ============================================================
   FOOTER
   ============================================================ */
.site-footer{ margin-top: 28px; padding: 20px 0; background: var(--header-bg); border-top:1px solid var(--header-line); }
.footer-grid{ display:flex; align-items:center; justify-content:space-between; gap: 16px; flex-wrap:wrap; }
.footer-links{ display:flex; gap: 12px; flex-wrap:wrap; }
.muted, .a-byline, .card-meta, .top-meta, #active-filter { color: var(--muted); font-size: .95rem; line-height: 1.5; }

/* ============================================================
   RESILIENCE & RESPONSIVE
   ============================================================ */

/* Robust wrapping to prevent layout wideners */
.article-body,
.card-title,
.top-title,
.a-title,
.h-section,
.page-title {
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* Stack two-column top-card at very small widths */
@media (max-width: 420px){
  .top-card{ grid-template-columns: 1fr; }
  .top-thumb{
    min-height: 150px; width: 100%; height: auto; aspect-ratio: 16/9; object-fit: cover;
  }
}